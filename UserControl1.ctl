VERSION 5.00
Begin VB.UserControl TitleBarButton 
   AutoRedraw      =   -1  'True
   ClientHeight    =   3600
   ClientLeft      =   0
   ClientTop       =   0
   ClientWidth     =   4800
   ScaleHeight     =   240
   ScaleMode       =   3  'Pixel
   ScaleWidth      =   320
   ToolboxBitmap   =   "UserControl1.ctx":0000
   Begin VB.PictureBox Picture1 
      AutoRedraw      =   -1  'True
      BackColor       =   &H00FF00FF&
      BorderStyle     =   0  'None
      Height          =   390
      Left            =   330
      ScaleHeight     =   26
      ScaleMode       =   3  'Pixel
      ScaleWidth      =   41
      TabIndex        =   0
      Top             =   1380
      Width           =   615
   End
   Begin RedHatSkin.TrackMouse TrackMouse1 
      Left            =   1215
      Top             =   540
      _ExtentX        =   741
      _ExtentY        =   741
   End
End
Attribute VB_Name = "TitleBarButton"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = True
Attribute VB_PredeclaredId = False
Attribute VB_Exposed = False
Private Const Button_1 = "19,16711935,16711935,16711935,16711935,16711935,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,16711935,16711935,16711935,1,1,16514043,16448250,16382457,16250871,16185078,16119285,15987699,15921906,15790320,15724527,15658734,15592941,15527148,15461355,9539985,16711935,16711935,1,16777215,16777215,11513775,11842740,12171705,12500670,12829635,13158600,13487565,13816530,14145495,14474460,14803425,15132390,15461355,15790320,9539985,16711935,1,16777215,12895428,12895428,13290186,13355979,13487565,13619151,13684944,13882323,14013909,14145495,14211288,14342874,14408667,14540253,14671839,14869218,9539985,16711935,1,16777215,12895428,13290186,13355979,13487565,13619151,13684944,13816530,14013909,14145495,14211288,14342874,14408667,14540253,14671839,14737632,14935011,9539985,1,16777215,11513775,13290186,13355979,13487565,13619151,13684944,13816530,13882323,14145495,14211288,14342874,14408667,14540253,14671839,14737632,14869218,15066597,9539985,1,16777215," & _
"11842740,13355979,13487565,13619151,13684944,4144959,4210752,14013909,14211288,14342874,14408667,14540253,14671839,14737632,14869218,14935011,15198183,9539985,1,16777215,12171705,13487565,13619151,13684944,4144959,4210752,4210752,4276545,14342874,14408667,14540253,14671839,14737632,14869218,14935011,15066597,15263976,9539985,1,16777215,12500670,13619151,13684944,13816530,4210752,4210752,4276545,4276545,4342338,14540253,14671839,14737632,14869218,14935011,15066597,15198183,15395562,9539985,1,16777215,12829635,13684944,13816530,13882323,14013909,4276545,4276545,4342338,4408131,4408131,14737632,14869218,14935011,15066597,15198183,15263976,15461355,9539985,1,16777215,13158600,13816530,13882323,14013909,14145495,14211288,4342338,4342338,4408131,4473924,4473924,14935011,15066597,15198183,15263976,15395562,15592941,9539985,1,16777215,13487565,13882323,14013909,14145495,14211288,14342874,14408667,4408131,4473924,4473924,4539717,4539717,15198183,15263976," & _
"15395562,15461355,15724527,9539985,1,16777215,13816530,14013909,14145495,14211288,14342874,14408667,14540253,4408131,4473924,4539717,4539717,4605510,15263976,15395562,15461355,15592941,15790320,9539985,1,16777215,14145495,14145495,14211288,14342874,14408667,14540253,4408131,4473924,4539717,4539717,4605510,15263976,15395562,15461355,15592941,15724527,15921906,9539985,1,16777215,14474460,14211288,14342874,14408667,14540253,4408131,4473924,4473924,4539717,4605510,15263976,15395562,15461355,15592941,15724527,15790320,15987699,9539985,1,16777215,14803425,14342874,14408667,14540253,4408131,4473924,4473924,4539717,4605510,15263976,15395562,15461355,15592941,15724527,15790320,15921906,16119285,9539985,1,16777215,15132390,14408667,14540253,14671839,4473924,4473924,4539717,4539717,15263976,15395562,15461355,15592941,15724527,15790320,15921906,15987699,16250871,9539985,1,16777215,15461355,14540253,14671839,14737632,14869218,4539717,4539717,15198183,15395562," & _
"15461355,15592941,15724527,15790320,15921906,15987699,16119285,16316664,9539985,1,16777215,15790320,14671839,14737632,14869218,14935011,15066597,15198183,15263976,15461355,15592941,15724527,15790320,15921906,15987699,16119285,16250871,16448250,9539985,1,16777215,16119285,14737632,14869218,14935011,15066597,15198183,15263976,15395562,15592941,15724527,15790320,15921906,15987699,16119285,16250871,16316664,16514043,9539985,1,16777215,16448250,14869218,14935011,15066597,15198183,15263976,15395562,15461355,15724527,15790320,15921906,15987699,16119285,16250871,16316664,16448250,16645629,9539985,1,10592673,10592673,10592673,10592673,10592673,10592673,10592673,10592673,10592673,10592673,10592673,10592673,10592673,10592673,10592673,10592673,10592673,10592673,10592673,1,6765608,6765608,6765608,6765608,6765608,6765608,6765608,6765608,6765608,6765608,6765608,6765608,6765608,6765608,6765608,6765608,6765608,6765608,6765608"
Private Const Button_2 = "19,1,16777215,16777215,16645629,16579836,16514043,16448250,16382457,16250871,16185078,16119285,15987699,15921906,15790320,15724527,15658734,15592941,15527148,15461355,9539985,1,16777215,10592673,10855845,11184810,11513775,11842740,12171705,12500670,12829635,13158600,13487565,13816530,14145495,14474460,14803425,15132390,15461355,15790320,9539985,1,16777215,10855845,13092807,13158600,13290186,13355979,13487565,13619151,13684944,13882323,14013909,14145495,14211288,14342874,14408667,14540253,14671839,14869218,9539985,1,16777215,11184810,13158600,13290186,13355979,13487565,13619151,13684944,13816530,14013909,14145495,14211288,14342874,14408667,14540253,14671839,14737632,14935011,9539985,1,16777215,11513775,13290186,13355979,13487565,13619151,13684944,13816530,13882323,14145495,14211288,14342874,14408667,14540253,14671839,14737632,14869218,15066597,9539985,1,16777215,11842740,13355979,13487565,13619151,13684944,13816530,13882323,14013909,14211288,9934743," & _
"4342338,4408131,10197915,14737632,14869218,14935011,15198183,9539985,1,16777215,12171705,13487565,13619151,13684944,13816530,13882323,14013909,14145495,14342874,4342338,4408131,4408131,4473924,14869218,14935011,15066597,15263976,9539985,1,16777215,12500670,13619151,13684944,13816530,13882323,14013909,14145495,14211288,14408667,4408131,4408131,4473924,4473924,14935011,15066597,15198183,15395562,9539985,1,16777215,12829635,13684944,13816530,13882323,14013909,14145495,14211288,14342874,14540253,4408131,4473924,4473924,4539717,15066597,15198183,15263976,15461355,9539985,1,16777215,13158600,13816530,13882323,14013909,14145495,14211288,14342874,14408667,14671839,4473924,4473924,4539717,4539717,15198183,15263976,15395562,15592941,9539985,1,16777215,13487565,13882323,14013909,14145495,14211288,14342874,14408667,14540253,14737632,4473924,4539717,4539717,4605510,15263976,15395562,15461355,15724527,9539985,1,16777215,13816530,14013909,14145495,14211288," & _
"14342874,14408667,14540253,14671839,14869218,4539717,4539717,4605510,4605510,15395562,15461355,15592941,15790320,9539985,1,16777215,14145495,14145495,14211288,14342874,14408667,14540253,14671839,14737632,14935011,4539717,4605510,4605510,4671303,15461355,15592941,15724527,15921906,9539985,1,16777215,14474460,14211288,14342874,14408667,14540253,14671839,14737632,14869218,15066597,4605510,4605510,4671303,4671303,15592941,15724527,15790320,15987699,9539985,1,16777215,14803425,14342874,14408667,14540253,14671839,14737632,14869218,14935011,15198183,10592673,4671303,4671303,10855845,15724527,15790320,15921906,16119285,9539985,1,16777215,15132390,14408667,14540253,14671839,14737632,14869218,14935011,15066597,15263976,15395562,15461355,15592941,15724527,15790320,15921906,15987699,16250871,9539985,1,16777215,15461355,14540253,14671839,14737632,14869218,14935011,15066597,15198183,15395562,15461355,15592941,15724527,15790320,15921906,15987699,16119285,16316664," & _
"9539985,1,16777215,15790320,14671839,14737632,14869218,14935011,15066597,15198183,15263976,15461355,15592941,15724527,15790320,15921906,15987699,16119285,16250871,16448250,9539985,1,16777215,16119285,14737632,14869218,14935011,15066597,15198183,15263976,15395562,15592941,15724527,15790320,15921906,15987699,16119285,16250871,16316664,16514043,9539985,1,16777215,16448250,14869218,14935011,15066597,15198183,15263976,15395562,15461355,15724527,15790320,15921906,15987699,16119285,16250871,16316664,16448250,16645629,9539985,1,10592673,10592673,10592673,10592673,10592673,10592673,10592673,10592673,10592673,10592673,10592673,10592673,10592673,10592673,10592673,10592673,10592673,10592673,10592673"
Private Const Button_3 = "19,1,16777215,16777215,16645629,16579836,16514043,16448250,16382457,16250871,16185078,16119285,15987699,15921906,15790320,15724527,15658734,15592941,15527148,15461355,9539985,1,16777215,10592673,10855845,11184810,11513775,11842740,12171705,12500670,12829635,13158600,13487565,13816530,14145495,14474460,14803425,15132390,15461355,15790320,9539985,1,16777215,10855845,13092807,13158600,13290186,13355979,13487565,13619151,13684944,13882323,14013909,14145495,14211288,14342874,14408667,14540253,14671839,14869218,9539985,1,16777215,11184810,13158600,13290186,13355979,13487565,13619151,13684944,13816530,14013909,14145495,14211288,14342874,14408667,14540253,14671839,14737632,14935011,9539985,1,16777215,11513775,13290186,13355979,13487565,13619151,13684944,13816530,13882323,14145495,14211288,14342874,14408667,14540253,14671839,14737632,14869218,15066597,9539985,1,16777215,11842740,13355979,13487565,4144959,4144959,4144959,4210752,4210752,4276545,4342338,4342338," & _
"4408131,4408131,14737632,14869218,14935011,15198183,9539985,1,16777215,12171705,13487565,13619151,4144959,4144959,4210752,4210752,14145495,14342874,14408667,14540253,14671839,4473924,14869218,14935011,15066597,15263976,9539985,1,16777215,12500670,13619151,13684944,4144959,4210752,4210752,4276545,14211288,14408667,14540253,14671839,14737632,4473924,14935011,15066597,15198183,15395562,9539985,1,16777215,12829635,13684944,13816530,4210752,4210752,4276545,4276545,14342874,14540253,14671839,14737632,14869218,4539717,15066597,15198183,15263976,15461355,9539985,1,16777215,13158600,13816530,13882323,4210752,4276545,4276545,4342338,14408667,14671839,14737632,14869218,14935011,4539717,15198183,15263976,15395562,15592941,9539985,1,16777215,13487565,13882323,14013909,4276545,4276545,4342338,4342338,14540253,14737632,14869218,14935011,15066597,4605510,15263976,15395562,15461355,15724527,9539985,1,16777215,13816530,14013909,14145495,4276545,4342338,4342338," & _
"4408131,14671839,14869218,14935011,15066597,15198183,4605510,15395562,15461355,15592941,15790320,9539985,1,16777215,14145495,14145495,14211288,4342338,4342338,4408131,4408131,14737632,14935011,15066597,15198183,15263976,4671303,15461355,15592941,15724527,15921906,9539985,1,16777215,14474460,14211288,14342874,4342338,4408131,4408131,4473924,14869218,15066597,15198183,15263976,15395562,4671303,15592941,15724527,15790320,15987699,9539985,1,16777215,14803425,14342874,14408667,4408131,4408131,4473924,4473924,4539717,4605510,4605510,4671303,4671303,4737096,15724527,15790320,15921906,16119285,9539985,1,16777215,15132390,14408667,14540253,14671839,14737632,14869218,14935011,15066597,15263976,15395562,15461355,15592941,15724527,15790320,15921906,15987699,16250871,9539985,1,16777215,15461355,14540253,14671839,14737632,14869218,14935011,15066597,15198183,15395562,15461355,15592941,15724527,15790320,15921906,15987699,16119285,16316664,9539985,1,16777215," & _
"15790320,14671839,14737632,14869218,14935011,15066597,15198183,15263976,15461355,15592941,15724527,15790320,15921906,15987699,16119285,16250871,16448250,9539985,1,16777215,16119285,14737632,14869218,14935011,15066597,15198183,15263976,15395562,15592941,15724527,15790320,15921906,15987699,16119285,16250871,16316664,16514043,9539985,1,16777215,16448250,14869218,14935011,15066597,15198183,15263976,15395562,15461355,15724527,15790320,15921906,15987699,16119285,16250871,16316664,16448250,16645629,9539985,1,10592673,10592673,10592673,10592673,10592673,10592673,10592673,10592673,10592673,10592673,10592673,10592673,10592673,10592673,10592673,10592673,10592673,10592673,10592673"
Private Const Button_4 = "19,1,16777215,16777215,16645629,16579836,16514043,16448250,16382457,16250871,16185078,16119285,15987699,15921906,15790320,15724527,15658734,15592941,15527148,15461355,9539985,1,16777215,10592673,10855845,11184810,11513775,11842740,12171705,12500670,12829635,13158600,13487565,13816530,14145495,14474460,14803425,15132390,15461355,15790320,9539985,1,16777215,10855845,13092807,13158600,13290186,13355979,13487565,13619151,13684944,13882323,14013909,14145495,14211288,14342874,14408667,14540253,14671839,14869218,9539985,1,16777215,11184810,13158600,13290186,13355979,13487565,13619151,13684944,13816530,14013909,14145495,14211288,14342874,14408667,14540253,14671839,14737632,14935011,9539985,1,16777215,11513775,13290186,13355979,13487565,13619151,13684944,13816530,13882323,14145495,14211288,14342874,14408667,14540253,14671839,14737632,14869218,15066597,9539985,1,16777215,11842740,13355979,13487565,13619151,4144959,4144959,13882323,14013909,14211288,14342874," & _
"4342338,4408131,14671839,14737632,14869218,14935011,15198183,9539985,1,16777215,12171705,13487565,13619151,4144959,4144959,4210752,4210752,14145495,14342874,4342338,4408131,4408131,4473924,14869218,14935011,15066597,15263976,9539985,1,16777215,12500670,13619151,13684944,4144959,4210752,4210752,4276545,4276545,4342338,4408131,4408131,4473924,4473924,14935011,15066597,15198183,15395562,9539985,1,16777215,12829635,13684944,13816530,13882323,4210752,4276545,4276545,4342338,4408131,4408131,4473924,4473924,14935011,15066597,15198183,15263976,15461355,9539985,1,16777215,13158600,13816530,13882323,14013909,14145495,4276545,4342338,4342338,4408131,4473924,4473924,14935011,15066597,15198183,15263976,15395562,15592941,9539985,1,16777215,13487565,13882323,14013909,14145495,14211288,4342338,4342338,4408131,4473924,4473924,4539717,15066597,15198183,15263976,15395562,15461355,15724527,9539985,1,16777215,13816530,14013909,14145495,14211288,4342338,4342338,4408131," & _
"4408131,4473924,4539717,4539717,4605510,15263976,15395562,15461355,15592941,15790320,9539985,1,16777215,14145495,14145495,14211288,4342338,4342338,4408131,4408131,4473924,4539717,4539717,4605510,4605510,4671303,15461355,15592941,15724527,15921906,9539985,1,16777215,14474460,14211288,14342874,4342338,4408131,4408131,4473924,14869218,15066597,4605510,4605510,4671303,4671303,15592941,15724527,15790320,15987699,9539985,1,16777215,14803425,14342874,14408667,14540253,4408131,4473924,14869218,14935011,15198183,15263976,4671303,4671303,15592941,15724527,15790320,15921906,16119285,9539985,1,16777215,15132390,14408667,14540253,14671839,14737632,14869218,14935011,15066597,15263976,15395562,15461355,15592941,15724527,15790320,15921906,15987699,16250871,9539985,1,16777215,15461355,14540253,14671839,14737632,14869218,14935011,15066597,15198183,15395562,15461355,15592941,15724527,15790320,15921906,15987699,16119285,16316664,9539985,16711935,1,16645629,14671839," & _
"14737632,14869218,14935011,15066597,15198183,15263976,15461355,15592941,15724527,15790320,15921906,15987699,16119285,16250871,16448250,9539985,16711935,1,16645629,14737632,14869218,14935011,15066597,15198183,15263976,15395562,15592941,15724527,15790320,15921906,15987699,16119285,16250871,16316664,16514043,9539985,16711935,16711935,1,13619151,13619151,15066597,15198183,15263976,15395562,15461355,15724527,15790320,15921906,15987699,16119285,16250871,16316664,16448250,16645629,9539985,16711935,16711935,16711935,1,1,12895428,12895428,12895428,12895428,12895428,12895428,12895428,12895428,12895428,12895428,12895428,12895428,12895428,12895428,9539985,16711935,16711935,16711935,16711935,16711935,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1"
Private Hold_Button As Integer

Private Over As Boolean
Private Down As Boolean

Public Event Click()


Property Get Button() As Integer
    Button = Hold_Button
End Property

Property Let Button(NewValue As Integer)
    Hold_Button = NewValue
    LoadGUI
End Property


Private Function LoadBmpMenuLines(Legnth As Integer, ColorPallet As String, X As Integer, Y As Integer, Optional Gray As Boolean = True, Optional Brightness As Integer = 0) As Integer
    If ColorPallet = "" Then Exit Function
    Dim PixCount
    Dim Colors() As String, CurrentRow, CurrentColumn, Count, Rows
    Colors = Split(ColorPallet, ",")
    Rows = Int(Split(ColorPallet, ",")(0))
    For Count = 1 To UBound(Colors)
        If CurrentRow > (Rows) Then CurrentRow = 0: CurrentColumn = CurrentColumn + 1
            If Colors(Count) = &HFF00FF And Brightness <> 0 Then
            
            Else
                If Gray = True Then
                Picture1.Line (X + CurrentColumn, Y + CurrentRow)-(X + CurrentColumn + Legnth, Y + CurrentRow), AdjustBrightness(Colors(Count), Brightness)
                Else
                Picture1.Line (X + CurrentColumn, Y + CurrentRow)-(X + CurrentColumn + Legnth, Y + CurrentRow), MakeGrey(Colors(Count))
                End If
            End If
        CurrentRow = CurrentRow + 1
    Next
    LoadBmpMenuLines = CurrentColumn
End Function

Function LoadGUI()
UserControl.Height = 20 * 15
Picture1.Top = 0
Picture1.Left = 0
Picture1.Height = UserControl.Height
Picture1.Cls
Dim X As Integer

Select Case Hold_Button
Case 0
    X = LoadBmpMenuLines(1, Button_1, 0, 0)
Case 1
    X = LoadBmpMenuLines(1, Button_2, 0, 0)
Case 2
    X = LoadBmpMenuLines(1, Button_3, 0, 0)
Case 3
    X = LoadBmpMenuLines(1, Button_4, 0, 0)
End Select
UserControl.Width = (X + 1) * 15
Picture1.Width = UserControl.Width
End Function

Function LoadGUI_Over()
UserControl.Height = 20 * 15
Picture1.Top = 0
Picture1.Left = 0
Picture1.Height = UserControl.Height
Picture1.Cls
Dim X As Integer

Select Case Hold_Button
Case 0
    X = LoadBmpMenuLines(1, Button_1, 0, 0, , 50)
Case 1
    X = LoadBmpMenuLines(1, Button_2, 0, 0, , 50)
Case 2
    X = LoadBmpMenuLines(1, Button_3, 0, 0, , 50)
Case 3
    X = LoadBmpMenuLines(1, Button_4, 0, 0, , 50)
End Select
UserControl.Width = (X + 1) * 15
Picture1.Width = UserControl.Width
End Function
Function LoadGUI_Down()
UserControl.Height = 20 * 15
Picture1.Top = 0
Picture1.Left = 0
Picture1.Height = UserControl.Height
Picture1.Cls
Dim X As Integer

Select Case Hold_Button
Case 0
    X = LoadBmpMenuLines(1, Button_1, 0, 0, , -50)
Case 1
    X = LoadBmpMenuLines(1, Button_2, 0, 0, , -50)
Case 2
    X = LoadBmpMenuLines(1, Button_3, 0, 0, , -50)
Case 3
    X = LoadBmpMenuLines(1, Button_4, 0, 0, , -50)
End Select
UserControl.Width = (X + 1) * 15
Picture1.Width = UserControl.Width
End Function

Private Sub Picture1_Click()
RaiseEvent Click
End Sub

Private Sub TrackMouse1_MouseLeftDown()
Down = True
LoadGUI_Down
End Sub

Private Sub TrackMouse1_MouseLeftUp()
Down = False
LoadGUI
End Sub

Private Sub TrackMouse1_MouseOut()
Over = False
LoadGUI
End Sub

Private Sub TrackMouse1_MouseOver()
If Over <> True Or Down <> True Then
    Over = True
    LoadGUI_Over
End If
End Sub

Private Sub UserControl_MouseUp(Button As Integer, Shift As Integer, X As Single, Y As Single)
RaiseEvent Click
End Sub

Private Sub UserControl_ReadProperties(PropBag As PropertyBag)
Hold_Button = PropBag.ReadProperty("Hold_Button", 0)
End Sub

Private Sub UserControl_Resize()
LoadGUI
End Sub

Private Sub UserControl_Show()
LoadGUI
End Sub

Private Sub UserControl_WriteProperties(PropBag As PropertyBag)
PropBag.WriteProperty "Hold_Button", Hold_Button, 0
End Sub

Function SubClass(Off As Boolean)
Select Case Off
Case True
TrackMouse1.CloseWatch
Case False
TrackMouse1.Watch Picture1
End Select
End Function


