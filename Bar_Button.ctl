VERSION 5.00
Begin VB.UserControl Bar_Button 
   AutoRedraw      =   -1  'True
   BackColor       =   &H00C0C0FF&
   ClientHeight    =   930
   ClientLeft      =   0
   ClientTop       =   0
   ClientWidth     =   840
   ScaleHeight     =   62
   ScaleMode       =   3  'Pixel
   ScaleWidth      =   56
   Begin RedHatSkin.TrackMouse TrackMouse1 
      Left            =   195
      Top             =   135
      _ExtentX        =   741
      _ExtentY        =   741
   End
   Begin VB.PictureBox Picture1 
      Appearance      =   0  'Flat
      AutoRedraw      =   -1  'True
      BackColor       =   &H00E6E6E6&
      BorderStyle     =   0  'None
      ForeColor       =   &H80000008&
      Height          =   555
      Left            =   105
      ScaleHeight     =   37
      ScaleMode       =   3  'Pixel
      ScaleWidth      =   46
      TabIndex        =   0
      Top             =   315
      Width           =   690
      Begin VB.Label Label1 
         Alignment       =   2  'Center
         BackStyle       =   0  'Transparent
         Caption         =   "Label1"
         BeginProperty Font 
            Name            =   "Tahoma"
            Size            =   9.75
            Charset         =   0
            Weight          =   400
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   300
         Left            =   0
         TabIndex        =   1
         Top             =   0
         Width           =   780
      End
   End
End
Attribute VB_Name = "Bar_Button"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = True
Attribute VB_PredeclaredId = False
Attribute VB_Exposed = False

Private Const Color_1 = "16,-1,-1,-1,-1,-1,-1,-1,14211288,10461087,14211288,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,3815994,3681836,6645093,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,9474192,4733240,14857391,1840662,12369084,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,14211288,1775640,13345951,14857391,10715260,3815994,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,6645093,7626075,15055027,14594219,14067360,4206639,9474192,-1,-1,-1,-1,-1,-1,-1,-1,-1,12369084,1840662,15252406,14857391,14067360,14000538,11633534,1775640,14211288,-1,-1,-1,-1,-1,-1,-1,-1,3815994,11505033,15055027,14000538,14393754,14393754,13013130,6177344,6645093,-1,-1,-1,-1,-1,-1,-1,9474192,4733240,15252406,14000538,13867153,14393754,14788512,13407374,12156792,1313802,12369084,-1,-1,-1,-1,-1,14211288,1775640,13345951,14264482,13274759,13867153,14393754,14788512,14393754,12156792,8277834,3815994,-1,-1,-1,-1,-1,6645093,7626075,14725548,12880001,12880001,13867153,14393754,14788512,14393754,13867153,10774111,3152665,9474192,-1,-1,-1,12369084," & _
"1840662,15055027,12682622,12682622,13274759,13867153,14393754,14788512,14393754,13867153,12682622,8802121,1446930,14211288,-1,-1,3815994,11505033,12552064,12156021,12682622,13274759,13867153,13867153,14788512,14393754,14393754,13472652,11695470,5057834,6645093,-1,9474192,4733240,13472652,11629420,12156021,12682622,13472652,13867153,14393754,14788512,14393754,13867153,13472652,12880001,10905697,1313802,12369084,921102,10778996,14393754,14393754,14393754,14393754,14393754,14393754,14393754,14393754,14393754,14393754,14393754,14393754,14393754,10778996,3815994,7566195,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,8553090"

Private Const Color_2 = "16,8553090,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,7566195,3815994,10778996,14393754,14393754,14393754,14393754,14393754,14393754,14393754,14393754,14393754,14393754,14393754,14393754,14393754,10778996,921102,12369084,1313802,10905697,12880001,13472652,13867153,14393754,14788512,14393754,13867153,13472652,12682622,12156021,11629420,13472652,4733240,9474192,-1,6645093,5057834,11695470,13472652,14393754,14393754,14788512,13867153,13867153,13274759,12682622,12156021,12552064,11505033,3815994,-1,-1,14211288,1446930,8802121,12682622,13867153,14393754,14788512,14393754,13867153,13274759,12682622,12682622,15055027,1840662,12369084,-1,-1,-1,9474192,3152665,10774111,13867153,14393754,14788512,14393754,13867153,12880001,12880001,14725548,7626075,6645093,-1,-1,-1,-1,-1,3815994,8277834,12156792,14393754,14788512,14393754,13867153,13274759,14264482,13345951,1775640,14211288,-1,-1,-1,-1,-1,12369084,1313802,12156792,13407374,14788512,14393754,13867153,14000538,15252406,4733240," & _
"9474192,-1,-1,-1,-1,-1,-1,-1,6645093,6177344,13013130,14393754,14393754,14000538,15055027,11505033,3815994,-1,-1,-1,-1,-1,-1,-1,-1,14211288,1775640,11633534,14000538,14067360,14857391,15252406,1840662,12369084,-1,-1,-1,-1,-1,-1,-1,-1,-1,9474192,4206639,14067360,14594219,15055027,7626075,6645093,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,3815994,10715260,14857391,13345951,1775640,14211288,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,12369084,1840662,14857391,4733240,9474192,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,6645093,3681836,3815994,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,14211288,10461087,14211288,-1,-1,-1,-1,-1,-1,-1"

Private Const Color_3 = "14,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,12369084,3815994,8553090,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,14211288,6645093,1313802,10778996,0,-1,-1,-1,-1,-1,-1,-1,-1,-1,9474192,1446930,5057834,10905697,14393754,0,-1,-1,-1,-1,-1,-1,-1,12369084,3815994,3152665,8802121,11695470,12880001,14393754,0,-1,-1,-1,-1,-1,14211288,6645093,1313802,8277834,10774111,12682622,13472652,13472652,14393754,0,-1,-1,-1,-1,9474192,1775640,6177344,12156792,12156792,13867153,13867153,14393754,13867153,14393754,0,-1,-1,12369084,3815994,4206639,11633534,13013130,13407374,14393754,14393754,14393754,14393754,14393754,14393754,0,14211288,6645093,1840662,10715260,14067360,14000538,14393754,14788512,14788512,14788512,14788512,14788512,14788512,14393754,0,10461087,3681836,14857391,14857391,14594219,14067360,14393754,14393754,14393754,14393754,14393754,13867153,14393754,14393754,0,14211288,3815994,4733240,13345951,15055027,14857391,14000538,13867153,13867153,13867153,13867153,13867153,13867153,14393754," & _
"0,-1,-1,9474192,1775640,7626075,15252406,15055027,14000538,13274759,12880001,13274759,13274759,13472652,14393754,0,-1,-1,-1,14211288,6645093,1840662,11505033,15252406,14264482,12880001,12682622,12682622,12682622,14393754,0,-1,-1,-1,-1,-1,12369084,3815994,4733240,13345951,14725548,12682622,12156021,12156021,14393754,0,-1,-1,-1,-1,-1,-1,-1,9474192,1775640,7626075,15055027,12552064,11629420,14393754,0,-1,-1,-1,-1,-1,-1,-1,-1,14211288,6645093,1840662,11505033,13472652,14393754,0,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,12369084,3815994,4733240,10778996,0,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,9474192,921102,7566195"

Private Const Color_4 = "21,-1,-1,-1,-1,14211288,8553090,3815994,3815994,3815994,5723991,9474192,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,10461087,1514263,4679752,7319665,7521397,6208353,3967038,1589529,2041375,10461087,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,11382189,2239010,10278301,10278301,9096844,10278301,8308864,9096844,6733416,3381046,600074,5723991,-1,-1,-1,-1,-1,-1,-1,-1,-1,14211288,2698025,11323821,11722419,11000488,5420629,1202708,600074,400902,2309412,3633977,2267173,604171,6645093,-1,-1,-1,-1,-1,-1,-1,-1,9474192,6383969,13888724,12772803,9096844,1469977,4737096,14211288,15132390,12369084,6645093,1054480,805390,201219,-1,-1,-1,-1,-1,-1,-1,-1,4737096,11581616,14282458,13101000,7521397,1988128,9474192,15132390,7566195,7566195,-1,-1,9474192,8553090,-1,-1,-1,-1,-1,-1,-1,-1,3815994,13293258,14282458,13101000,8440194,5872987,2829099,2829099,4942156,1451287,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,3815994,11385006,13363660,12444606,10672292,9096844,6058077,11187882,11722419,2306851," & _
"-1,14211288,7566195,11382189,-1,-1,-1,-1,-1,-1,-1,-1,8553090,8752005,13888724,11722419,10672292,9687445,12444606,13363660,11197356,0,-1,7566195,2306851,4015933,1514263,4737096,9474192,13290186,-1,-1,-1,-1,13290186,3028270,14411740,11722419,9884568,8834184,8834184,6733416,8834184,0,-1,7566195,1336342,11722419,14939107,11846580,6058077,1909533,2829099,6645093,12369084,-1,-1,3815994,6846057,10672292,8834184,7915131,7061613,5945949,5420629,0,-1,7566195,1669148,10278301,12772803,12444606,11197356,8834184,6471012,2583849,133634,14211288,3815994,4149824,9488273,8440194,7849593,7061613,6208353,5157969,2401064,2829099,-1,7566195,1669148,9687445,11722419,11197356,10672292,9687445,6993772,600074,5723991,11382189,1584921,7319665,10278301,11000488,9687445,7849593,5157969,4238916,2138404,3815994,-1,6645093,1669148,8834184,10672292,10540962,9884568,7915131,1521688,6645093,15132390,-1,8553090,3815994,989455,3823931,6131039,7847033,7258737,4632905,2138404,3815994," & _
"-1,3815994,3245108,8308864,6733416,8440194,8834184,7521397,2330662,1907997,15132390,-1,-1,-1,14211288,10461087,5723991,1907997,1059601,1202708,1472025,3815994,-1,3815994,4689226,6208353,5420629,5420629,8177790,7849593,4961102,668171,11382189,-1,-1,-1,-1,-1,-1,-1,12369084,8553090,3815994,9474192,-1,3815994,6133343,4815691,1584921,5945949,6733416,6733416,6208353,1265941,7566195,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,3815994,2306851,4737096,4737096,4553031,6471012,5945949,5420629,1988128,7566195,-1,-1,-1,-1,-1,-1,-1,-1,10461087,133634,3815994,11382189,13290186,11382189,15132390,10461087,4220226,6471012,4961102,4632905,1589529,10461087,-1,-1,-1,-1,-1,-1,-1,-1,10461087,600074,1669148,668171,1907997,4737096,5723991,2369828,7645558,4632905,4173378,3514680,1054480,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,7566195,600074,2267173,2138404,4098112,4557895,7061613,4173378,3582521,3188788,930832,9474192,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,9474192,1054480,2583849,2529834,2860591," & _
"2991921,2860591,2330662,600074,6645093,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,14211288,7566195,1907997,400902,600074,201219,3815994,11382189,-1,-1,-1"

Private Const Color_5 = "21,-1,-1,-1,-1,-1,-1,14211288,4737096,7566195,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,4737096,3355443,3355443,6118749,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,8553090,2368548,7566195,7105644,6052956,1842204,200737,792618,792618,792618,792618,792618,792618,1513239,5723991,10461087,-1,-1,-1,-1,-1,12369084,657930,7105644,7105644,7566195,7105644,7105644,5597053,2777514,3239372,3699923,3766744,3766744,3766744,3766744,2314384,401230,5723991,-1,-1,-1,14211288,2829099,6052956,7566195,7105644,7105644,7105644,7105644,6579300,1315860,867996,1133736,1333939,1333939,1333939,1333939,1333939,1000583,3815994,-1,-1,-1,5723991,4408131,7566195,7566195,7566195,7105644,7566195,7105644,2829099,467543,935073,1333939,1333939,1333939,1333939,1333939,1333939,1000583,3815994,-1,-1,9474192,2368548,7566195,7566195,7566195,7566195,7566195,7566195,4408131,267056,867996,1333939,1333939,1333939,1333939,1333939,1333939,1333939,1000583,3815994,-1,12369084,1513239," & _
"7566195,8026746,7566195,7566195,7566195,7105644,6052956,527898,801426,1266606,1333939,1333939,1333939,1333939,1333939,1333939,1333939,1000583,3815994,14211288,2829099,6052956,8026746,8026746,7566195,7566195,7566195,7105644,1315860,734856,1133736,1333939,1333939,1333939,1333939,1333939,1333939,1333939,1333939,1000583,3815994,6645093,4079166,8026746,8026746,7566195,7566195,7566195,7566195,2829099,467543,935073,1333939,1333169,1133736,1133736,1133736,1133736,1133736,1067686,1133736,801150,3815994,1315860,8026746,8026746,8026746,8026746,8026746,7566195,4802889,267056,935073,1333169,1333939,1266606,5732017,10858953,11122125,11122125,11714261,11714261,11911641,9081764,3815994,2829099,3355443,8026746,8026746,8026746,8026746,6579300,527898,801426,1266606,1333939,1333939,1266606,5732017,14342874,14342874,12895428,10329501,15461355,15461355,11842740,3815994,13290186,921102,3355443,6052956,8026746,8026746,1315860,601717,1133736,1333939,1333939,1333939,1333169," & _
"7375288,14342874,14342874,9145227,4802889,15461355,15461355,11842740,4276545,-1,10461087,657930,3355443,4408131,4408131,268090,934303,1133736,1333939,1333939,1333939,1133736,7375288,14342874,14342874,14869218,14869218,15461355,15461355,11842740,3815994,-1,-1,6645093,1315860,3355443,3355443,657930,668286,867996,1333169,1333939,1333939,1333169,7375288,14342874,14342874,14869218,14869218,15461355,15461355,11842740,3815994,-1,-1,-1,2829099,2368548,3355443,2368548,330259,933769,934303,1333939,1333939,1333169,5732017,10858953,11122125,11122125,11451090,11714261,11911641,9081764,3815994,-1,-1,-1,13290186,921102,2829099,3355443,1842204,268090,867996,1133736,1333939,1333169,1133736,1133736,1133736,1133736,1067686,1133736,1133736,933769,3815994,-1,-1,-1,-1,10461087,657930,3355443,3355443,1315860,534113,867996,1333169,1333939,1333939,1333939,1333939,1333939,1333939,1333939,1333939,1333939,3815994,-1,-1,-1,-1,-1,6645093,1315860,3355443,2829099,330259,734856,934303," & _
"1333939,1333939,1333939,1333939,1333939,1333939,1333939,1333939,1333939,3815994,-1,-1,-1,-1,-1,-1,2829099,1842204,3355443,2368548,133917,867996,1133736,1333939,1333939,1333939,1333939,1333939,1333939,1333939,1333939,3815994,-1,-1,-1,-1,-1,-1,14211288,3815994,1119515,2368548,1842204,401230,867996,1333169,1333939,1333939,1333939,1333939,1333939,1333939,1333939,3815994,-1,-1,-1,-1,-1,-1,-1,-1,11382189,3815994,657930,0,0,0,0,0,0,0,0,0,0,7566195,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,11382189,7566195,14211288,-1,-1,-1,-1,-1,-1,-1,-1,-1"

Private Over As Boolean
Private Down As Boolean

Private Hold_Caption As String
Private Hold_Icon As Integer
Private Hold_Enabled As Boolean

Public Event Clicked()
Public Event MouseOver()
Public Event MouseOff()


Property Get Enabled() As Boolean
Enabled = Hold_Enabled
End Property

Public Property Let Enabled(NewValue As Boolean)
Hold_Enabled = NewValue
LoadGUI
End Property

Property Get Icon() As Integer
Icon = Hold_Icon
End Property

Public Property Let Icon(NewValue As Integer)
Hold_Icon = NewValue
LoadGUI
End Property


Property Get Caption() As String
Caption = Hold_Caption
End Property

Public Property Let Caption(NewValue As String)
Hold_Caption = NewValue
Label1.Caption = NewValue
End Property

Private Function LoadBmpMenuLines(Legnth As Integer, ColorPallet As String, X As Integer, Y As Integer, Optional Gray As Boolean = True, Optional Brightness As Integer = 0) As Integer
    If ColorPallet = "" Then Exit Function
    Dim PixCount
    Dim Colors() As String, CurrentRow, CurrentColumn, Count, Rows
    Colors = Split(ColorPallet, ",")
    Rows = Int(Split(ColorPallet, ",")(0))
    For Count = 1 To UBound(Colors)
        If CurrentRow > (Rows) Then CurrentRow = 0: CurrentColumn = CurrentColumn + 1
            If Colors(Count) <> -1 Then
                If Gray = True Then
                Picture1.Line (X + CurrentColumn, Y + CurrentRow)-(X + CurrentColumn + Legnth, Y + CurrentRow), AdjustBrightness(Colors(Count), Brightness)
                Else
                Picture1.Line (X + CurrentColumn, Y + CurrentRow)-(X + CurrentColumn + Legnth, Y + CurrentRow), MakeGrey(Colors(Count))
                End If
            End If
        CurrentRow = CurrentRow + 1
    Next
    LoadBmpMenuLines = CurrentColumn
End Function

Function LoadGUI()
Picture1.Top = 0
Picture1.Left = 0
Picture1.Width = UserControl.Width
Picture1.Height = UserControl.Height
Picture1.Cls

If Hold_Enabled = True Then
LoadIcon
Else
LoadIcon , , , False
End If

Label1.Top = UserControl.ScaleHeight - Label1.Height
Label1.Left = 0
Label1.Width = UserControl.ScaleWidth
End Function

Function LoadGUI_Over()
Picture1.Cls

LoadIcon 50

Picture1.Line (UserControl.ScaleWidth - 2, 0)-(UserControl.ScaleWidth - 2, UserControl.ScaleHeight), 12895428
Picture1.Line (UserControl.ScaleWidth - 1, 0)-(UserControl.ScaleWidth - 1, UserControl.ScaleHeight), 16119285

Picture1.Line (1, 0)-(1, UserControl.ScaleHeight), 12895428
Picture1.Line (2, 0)-(2, UserControl.ScaleHeight), 16119285


Label1.Top = UserControl.ScaleHeight - Label1.Height
Label1.Left = 0
Label1.Width = UserControl.ScaleWidth
End Function

Function LoadGUI_Down()
Picture1.Cls

LoadIcon 50, 1, 2

Picture1.Line (UserControl.ScaleWidth - 1, 0)-(UserControl.ScaleWidth - 1, UserControl.ScaleHeight), 12895428
Picture1.Line (UserControl.ScaleWidth - 2, 0)-(UserControl.ScaleWidth - 2, UserControl.ScaleHeight), 16119285

Picture1.Line (2, 0)-(2, UserControl.ScaleHeight), 12895428
Picture1.Line (1, 0)-(1, UserControl.ScaleHeight), 16119285

Label1.Top = UserControl.ScaleHeight - Label1.Height + 2
Label1.Left = 2
Label1.Width = UserControl.ScaleWidth
End Function

Private Function LoadIcon(Optional Brightness As Integer = 0, Optional Add_X As Integer = 0, Optional Add_Y As Integer = 0, Optional NOGrey As Boolean = True)
Select Case Hold_Icon
Case 0
LoadBmpMenuLines 1, Color_1, ((UserControl.ScaleWidth / 2) - 8) + Add_X, (UserControl.ScaleHeight * 0.25) + Add_Y, NOGrey, Brightness
Case 1
LoadBmpMenuLines 1, Color_2, ((UserControl.ScaleWidth / 2) - 8) + Add_X, (UserControl.ScaleHeight * 0.25) + Add_Y, NOGrey, Brightness
Case 2
LoadBmpMenuLines 1, Color_3, ((UserControl.ScaleWidth / 2) - 8) + Add_X, (UserControl.ScaleHeight * 0.25) + Add_Y, NOGrey, Brightness
Case 3
LoadBmpMenuLines 1, Color_4, ((UserControl.ScaleWidth / 2) - 8) + Add_X, (UserControl.ScaleHeight * 0.25) + Add_Y, NOGrey, Brightness
Case 4
LoadBmpMenuLines 1, Color_5, ((UserControl.ScaleWidth / 2) - 8) + Add_X, (UserControl.ScaleHeight * 0.25) + Add_Y, NOGrey, Brightness
End Select
End Function

Private Sub TrackMouse1_MouseLeftDown()
If Hold_Enabled <> True Then Exit Sub
Down = True
LoadGUI_Down
End Sub

Private Sub TrackMouse1_MouseLeftUp()
If Hold_Enabled <> True Then Exit Sub
Down = False
LoadGUI_Over
RaiseEvent Clicked
End Sub

Private Sub TrackMouse1_MouseOut()
If Hold_Enabled <> True Then Exit Sub
Over = False
LoadGUI
RaiseEvent MouseOff
End Sub

Private Sub TrackMouse1_MouseOver()
If Hold_Enabled <> True Then Exit Sub
Screen.MousePointer = 0
If Over <> True And Down <> True Then
LoadGUI_Over
Over = True
End If
RaiseEvent MouseOver
End Sub

Private Sub UserControl_ReadProperties(PropBag As PropertyBag)
Hold_Caption = PropBag.ReadProperty("Hold_Caption", "Button")
Hold_Icon = PropBag.ReadProperty("Hold_Icon", 0)
Hold_Enabled = PropBag.ReadProperty("Hold_Enabled", True)
Label1.Caption = Hold_Caption
End Sub

Private Sub UserControl_Resize()
LoadGUI
End Sub

Private Sub UserControl_Show()
LoadGUI
End Sub

Function SubClassMe(SubClass As Boolean)
If SubClass = True Then
TrackMouse1.Watch Picture1
Else
TrackMouse1.CloseWatch
End If
End Function

Private Sub UserControl_WriteProperties(PropBag As PropertyBag)
PropBag.WriteProperty "Hold_Caption", Hold_Caption, "Button"
PropBag.WriteProperty "Hold_Icon", Hold_Icon, 0
PropBag.WriteProperty "Hold_Enabled", Hold_Enabled, True
End Sub
